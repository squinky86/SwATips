<!DOCTYPE html>
<html xml:lang='en-US' lang='en-US'>
<head>
<title>Stripping for Fun and Profit</title>
 

<meta charset="utf-8"/>
 

<meta content="TeX4ht (https://tug.org/tex4ht/)" name="generator"/>
 

<meta content="width=device-width,initial-scale=1" name="viewport"/>
 

 

<meta content="article.tex" name="src"/>
 

<script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4110907817782130" crossorigin="anonymous"></script>
<style>
 
/* start css.sty */
.rm-lmr-7{font-size:70%;}
.rm-lmbx-12x-x-144{font-size:172%; font-weight: bold;}
.rm-lmr-9{font-size:90%;}
.rm-lmr-12{font-size:120%;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-9{font-size:90%; font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{font-size:90%; font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtti-10x-x-90{font-size:90%; font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtt-8x-x-87{font-size:69%; font-family: monospace,monospace;}
.ec-lmtt-8x-x-87{ font-family: monospace,monospace;}
.ec-lmtt-8x-x-87{ font-family: monospace,monospace;}
.ec-lmtt-8x-x-87{ font-family: monospace,monospace;}
.ec-lmtt-8x-x-87{ font-family: monospace,monospace;}
.ec-lmtt-8x-x-87{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{font-size:70%; font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-70{ font-family: monospace,monospace;}
.rm-lmri-10{ font-style:italic;}
p{margin-top:0;margin-bottom:0}
p.indent{text-indent:0;}
p + p{margin-top:1em;}
p + div, p + pre {margin-top:1em;}
div + p, pre + p {margin-top:1em;}
a { overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; hyphens: auto; }
@media print {div.crosslinks {visibility:hidden;}}
a img { border-top: 0; border-left: 0; border-right: 0; }
center { margin-top:1em; margin-bottom:1em; }
td center { margin-top:0em; margin-bottom:0em; }
.Canvas { position:relative; }
img.math{vertical-align:middle;}
div.par-math-display, div.math-display{text-align:center;}
li p.indent { text-indent: 0em }
li p:first-child{ margin-top:0em; }
li p:last-child, li div:last-child { margin-bottom:0.5em; }
li p~ul:last-child, li p~ol:last-child{ margin-bottom:0.5em; }
.enumerate1 {list-style-type:decimal;}
.enumerate2 {list-style-type:lower-alpha;}
.enumerate3 {list-style-type:lower-roman;}
.enumerate4 {list-style-type:upper-alpha;}
div.newtheorem { margin-bottom: 2em; margin-top: 2em;}
.obeylines-h,.obeylines-v {white-space: nowrap; }
div.obeylines-v p { margin-top:0; margin-bottom:0; }
.overline{ text-decoration:overline; }
.overline img{ border-top: 1px solid black; }
td.displaylines {text-align:center; white-space:nowrap;}
.centerline {text-align:center;}
.rightline {text-align:right;}
pre.verbatim {font-family: monospace,monospace; text-align:left; clear:both; }
.fbox {padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.fbox {display:table}
div.center div.fbox {text-align:center; clear:both; padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.minipage{width:100%;}
div.center, div.center div.center {text-align: center; margin-left:1em; margin-right:1em;}
div.center div {text-align: left;}
div.flushright, div.flushright div.flushright {text-align: right;}
div.flushright div {text-align: left;}
div.flushleft {text-align: left;}
.underline{ text-decoration:underline; }
.underline img{ border-bottom: 1px solid black; margin-bottom:1pt; }
.framebox-c, .framebox-l, .framebox-r { padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
.framebox-c {text-align:center;}
.framebox-l {text-align:left;}
.framebox-r {text-align:right;}
span.thank-mark{ vertical-align: super }
span.footnote-mark sup.textsuperscript, span.footnote-mark a sup.textsuperscript{ font-size:80%; }
div.footnotes{border-top:solid 1px black; border-bottom:solid 1px black; padding-bottom:1ex; padding-top:0.5ex; margin-right:15%; margin-top:2ex; font-style:italic; font-size:85%;}
div.footnotes p{margin-top:0; margin-bottom:0; text-indent:0;}
div.tabular, div.center div.tabular {text-align: center; margin-top:0.5em; margin-bottom:0.5em; }
table.tabular td p{margin-top:0em;}
table.tabular {margin-left: auto; margin-right: auto;}
td p:first-child{ margin-top:0em; }
td p:last-child{ margin-bottom:0em; }
div.td00{ margin-left:0pt; margin-right:0pt; }
div.td01{ margin-left:0pt; margin-right:5pt; }
div.td10{ margin-left:5pt; margin-right:0pt; }
div.td11{ margin-left:5pt; margin-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
td.td00{ padding-left:0pt; padding-right:0pt; }
td.td01{ padding-left:0pt; padding-right:5pt; }
td.td10{ padding-left:5pt; padding-right:0pt; }
td.td11{ padding-left:5pt; padding-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
.hline hr, .cline hr{ height : 0px; margin:0px; }
.hline td, .cline td{ padding: 0; }
.hline hr, .cline hr{border:none;border-top:1px solid black;}
.tabbing-right {text-align:right;}
div.float, div.figure {margin-left: auto; margin-right: auto;}
div.float img {text-align:center;}
div.figure img {text-align:center;}
.marginpar,.reversemarginpar {width:20%; float:right; text-align:left; margin-left:auto; margin-top:0.5em; font-size:85%; text-decoration:underline;}
.marginpar p,.reversemarginpar p{margin-top:0.4em; margin-bottom:0.4em;}
.reversemarginpar{float:left;}
table.equation {width:100%;}
.equation td{text-align:center; }
td.equation { margin-top:1em; margin-bottom:1em; } 
td.equation-label { width:5%; text-align:center; }
td.eqnarray4 { width:5%; white-space: normal; }
td.eqnarray2 { width:5%; }
table.eqnarray-star, table.eqnarray {width:100%;}
div.eqnarray{text-align:center;}
div.array {text-align:center;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.pmatrix img{vertical-align:middle;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.bar-css {text-decoration:overline;}
table.tabular{border-collapse: collapse; border-spacing: 0;}
img.cdots{vertical-align:middle;}
.partToc a, .partToc, .likepartToc a, .likepartToc {line-height: 200%; font-weight:bold; font-size:110%;}
.chapterToc a, .chapterToc, .likechapterToc a, .likechapterToc, .appendixToc a, .appendixToc {line-height: 200%; font-weight:bold;}
.index-item, .index-subitem, .index-subsubitem {display:block}
div.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:left;}
div.caption span.id{font-weight: bold; white-space: nowrap; }
h1.partHead{text-align: center}
p.bibitem { text-indent: -2em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
p.bibitem-p { text-indent: 0em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
.paragraphHead, .likeparagraphHead { margin-top:2em; font-weight: bold;}
.subparagraphHead, .likesubparagraphHead { font-weight: bold;}
.verse{white-space:nowrap; margin-left:2em}
div.maketitle {text-align:center;}
h2.titleHead{text-align:center;}
div.maketitle{ margin-bottom: 2em; }
div.author, div.date {text-align:center;}
div.thanks{text-align:left; margin-left:10%; font-size:85%; font-style:italic; }
div.abstract p {margin-left:5%; margin-right:5%;}
div.abstract {width:100%;}
.abstracttitle{text-align:center;margin-bottom:1em;}
figure.float, div.figure {margin-left: auto; margin-right: auto;}
figure.float img, figure.figure img {display: block; margin-left: auto; margin-right: auto;}
figure.figure {text-align:center;}
figcaption.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:center;}
figcaption.caption span.id{font-weight: bold; white-space: nowrap; }
.abstract{margin:1em;}
dt.printshorthands{float:left; clear:left; margin-right:1em;}
dd.thebibliography {margin-left: 2.5em;}
dt.thebibliography {float:left; clear:left; margin-right:1em;}
.lstlisting .label{margin-right:0.5em; }
div.lstlisting{font-family: monospace,monospace; white-space: nowrap; margin-top:0.5em; margin-bottom:0.5em; }
div.lstinputlisting{ font-family: monospace,monospace; white-space: nowrap; }
.lstinputlisting .label{margin-right:0.5em;}
.small-caps{font-variant: small-caps;}
/* end css.sty */

</style>
</head>
<body>
<p>Return to <a href="../">SwATips</a> | <a href="20210802.pdf">pdf</a> | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img src="images/by.svg" width="60" height="21" alt="CC-BY" /></a></p>
<div class='maketitle'>
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class='titleHead'> <strong>Software Assurance Tips</strong><br />
A product of the Software Assurance Tips Team[<a href='#cite.0@swatips'>1</a>]<br />
Generated Monday 2<sup class='textsuperscript'>nd</sup> August, 2021</h2>
<div class='author'><span class='rm-lmr-12'>Jon Hood</span></div><br />
<div class='date'><span class='rm-lmr-12'>Monday 2</span><sup class='textsuperscript'><span class='rm-lmr-9'>nd</span></sup><span class='rm-lmr-12'> August, 2021</span></div>
</div>
                                                                                         
                                                                                         
   
<h3 class='sectionHead'><span class='titlemark'>1   </span> <a id='x1-10001'></a>Stripping for Fun and Profit</h3>
<!-- l. 1 --><p class='noindent'>Recently, we were given a piece of software with special handling instructions. The software contained a function
which was supposed to be protected: enemies, competitors, and no one without a need-to-know was to ever see how
this function manipulated the parameters it was given.
</p><!-- l. 3 --><p class='indent'>   While reviewing the security of the software, we discovered that the developer compiled the binary and released
it on their website. When asked how they were able to release such a private routine publicly, the customer claimed
that it was fine to release in binary form. Supposedly, the compilation method they used removed the “context of
the Human-Readable Source Code used to generate the Machine-Readable Object Code from propagating into the
Machine-Readable Object Code.”
</p><!-- l. 5 --><p class='indent'>   Let’s put this claim to the test! For the sake of creating a fully unclassified example, suppose that no one has
ever created a function for calculating factorials, and a new intern fresh out of college submits the code in Listing <a href='#x1-1001r1'>1<!-- tex4ht:ref: lst:20210802:factorial  --></a>
to solve this highly-secretive, important function. </p><!-- l. 6 -->
<p><a id='x1-1001r1'></a></p>
<p><a id='x1-1002'></a></p>   
<div id='listing-1' class='lstlisting'><span class='label'><a id='x1-1003r1'></a></span><span class='ec-lmtk-10x-x-90'>#include</span><span class='ec-lmtt-9'> &lt;stdio.h&gt; </span><br /><span class='label'><a id='x1-1004r2'></a></span><span class='ec-lmtk-10x-x-90'>#include</span><span class='ec-lmtt-9'> &lt;stdlib.h&gt; </span><br /><span class='label'><a id='x1-1005r3'></a></span><span class='ec-lmtk-10x-x-90'>void</span><span class='ec-lmtt-9'> factorial(</span><span class='ec-lmtk-10x-x-90'>int</span><span class='ec-lmtt-9'> argc, </span><span class='ec-lmtk-10x-x-90'>char</span><span class='ec-lmtt-9'> *argv[]) </span><br /><span class='label'><a id='x1-1006r4'></a></span><span class='ec-lmtt-9'>{ </span><span class='ec-lmtti-10x-x-90'>//SUPER SEKRIT FACTORIALS</span><span class='ec-lmtt-9'> </span><br /><span class='label'><a id='x1-1007r5'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>unsigned</span><span class='ec-lmtt-9'> </span><span class='ec-lmtk-10x-x-90'>long</span><span class='ec-lmtt-9'> </span><span class='ec-lmtk-10x-x-90'>long</span><span class='ec-lmtt-9'> ret = 1; </span><br /><span class='label'><a id='x1-1008r6'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>int</span><span class='ec-lmtt-9'> maxVal = atoi(argv[1]); </span><span class='ec-lmtti-10x-x-90'>//0&lt;=maxVal&lt;=20</span><span class='ec-lmtt-9'> </span><br /><span class='label'><a id='x1-1009r7'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>for</span><span class='ec-lmtt-9'> (</span><span class='ec-lmtk-10x-x-90'>int</span><span class='ec-lmtt-9'> i = 1; i &lt;= maxVal; i++) </span><br /><span class='label'><a id='x1-1010r8'></a></span><span class='ec-lmtt-9'>               ret = ret * (</span><span class='ec-lmtk-10x-x-90'>unsigned</span><span class='ec-lmtt-9'> </span><span class='ec-lmtk-10x-x-90'>long</span><span class='ec-lmtt-9'> </span><span class='ec-lmtk-10x-x-90'>long</span><span class='ec-lmtt-9'>)i; </span><br /><span class='label'><a id='x1-1011r9'></a></span><span class='ec-lmtt-9'>        printf("%llu\n", ret); </span><br /><span class='label'><a id='x1-1012r10'></a></span><span class='ec-lmtt-9'>}</span>
<figcaption class='caption'><span class='id'>Listing 1:</span><span class='content'>Unsafe Factorial Function</span></figcaption><!-- tex4ht:label?: x1-1001r1  -->
   
</div>
<!-- l. 19 --><p class='indent'>   When compiled into machine code, the function isn’t nearly as easy to follow. Figures <a href='#x1-1013r2'>2<!-- tex4ht:ref: lst:20210802:machine  --></a> and <a href='#x1-1045r3'>3<!-- tex4ht:ref: lst:20210802:machine2  --></a> show the
unstripped and stripped functional machine code respectively. Had the software been compiled in debug mode, the
source code would have been included alongside the machine code.
</p>   
<div class='minipage'><!-- l. 22 -->
<a id='x1-1013r2'></a>
<a id='x1-1014'></a>
<div id='listing-2' class='lstlisting'><span class='label'><a id='x1-1015r1'></a></span><span class='ec-lmtt-9'>push   %rbp </span><br /><span class='label'><a id='x1-1016r2'></a></span><span class='ec-lmtt-9'>mov    %rsp,%rbp </span><br /><span class='label'><a id='x1-1017r3'></a></span><span class='ec-lmtt-9'>sub    $0x30,%rsp </span><br /><span class='label'><a id='x1-1018r4'></a></span><span class='ec-lmtt-9'>mov    %ecx,0x10(%rbp) </span><br /><span class='label'><a id='x1-1019r5'></a></span><span class='ec-lmtt-9'>mov    %rdx,0x18(%rbp) </span><br /><span class='label'><a id='x1-1020r6'></a></span><span class='ec-lmtt-9'>movl   $0x1,-0x4(%rbp) </span><br /><span class='label'><a id='x1-1021r7'></a></span><span class='ec-lmtt-9'>mov    0x18(%rbp),%rax </span><br /><span class='label'><a id='x1-1022r8'></a></span><span class='ec-lmtt-9'>add    $0x8,%rax </span><br /><span class='label'><a id='x1-1023r9'></a></span><span class='ec-lmtt-9'>mov    (%rax),%rax </span><br /><span class='label'><a id='x1-1024r10'></a></span><span class='ec-lmtt-9'>mov    %rax,%rcx </span><br /><span class='label'><a id='x1-1025r11'></a></span><span class='ec-lmtt-9'>call   29 &lt;factorial+0x29&gt; </span><br /><span class='label'><a id='x1-1026r12'></a></span><span class='ec-lmtt-9'>mov    %eax,-0xc(%rbp) </span><br /><span class='label'><a id='x1-1027r13'></a></span><span class='ec-lmtt-9'>movl   $0x1,-0x8(%rbp) </span><br /><span class='label'><a id='x1-1028r14'></a></span><span class='ec-lmtt-9'>jmp    45 &lt;factorial+0x45&gt; </span><br /><span class='label'><a id='x1-1029r15'></a></span><span class='ec-lmtt-9'>mov    -0x8(%rbp),%eax </span><br /><span class='label'><a id='x1-1030r16'></a></span><span class='ec-lmtt-9'>mov    -0x4(%rbp),%edx </span><br /><span class='label'><a id='x1-1031r17'></a></span><span class='ec-lmtt-9'>imul   %edx,%eax </span><br /><span class='label'><a id='x1-1032r18'></a></span><span class='ec-lmtt-9'>mov    %eax,-0x4(%rbp) </span><br /><span class='label'><a id='x1-1033r19'></a></span><span class='ec-lmtt-9'>addl   $0x1,-0x8(%rbp) </span><br /><span class='label'><a id='x1-1034r20'></a></span><span class='ec-lmtt-9'>mov    -0x8(%rbp),%eax </span><br /><span class='label'><a id='x1-1035r21'></a></span><span class='ec-lmtt-9'>cmp    -0xc(%rbp),%eax </span><br /><span class='label'><a id='x1-1036r22'></a></span><span class='ec-lmtt-9'>jle    35 &lt;factorial+0x35&gt; </span><br /><span class='label'><a id='x1-1037r23'></a></span><span class='ec-lmtt-9'>mov    -0x4(%rbp),%eax </span><br /><span class='label'><a id='x1-1038r24'></a></span><span class='ec-lmtt-9'>mov    %eax,%edx </span><br /><span class='label'><a id='x1-1039r25'></a></span><span class='ec-lmtt-9'>lea    0x0(%rip),%rax # 59 &lt;factorial+0x59&gt; </span><br /><span class='label'><a id='x1-1040r26'></a></span><span class='ec-lmtt-9'>mov    %rax,%rcx </span><br /><span class='label'><a id='x1-1041r27'></a></span><span class='ec-lmtt-9'>call   61 &lt;factorial+0x61&gt; </span><br /><span class='label'><a id='x1-1042r28'></a></span><span class='ec-lmtt-9'>nop </span><br /><span class='label'><a id='x1-1043r29'></a></span><span class='ec-lmtt-9'>add    $0x30,%rsp </span><br /><span class='label'><a id='x1-1044r30'></a></span><span class='ec-lmtt-9'>pop    %rbp</span>
<figcaption class='caption'><span class='id'>Listing 2:</span><span class='content'>Unstripped Machine Code</span></figcaption><!-- tex4ht:label?: x1-1013r1  -->
</div>
</div> <div class='minipage'><!-- l. 56 -->
<a id='x1-1045r3'></a>
<a id='x1-1046'></a>
<div id='listing-3' class='lstlisting'><span class='label'><a id='x1-1047r1'></a></span><span class='ec-lmtt-9'>push   %rbp </span><br /><span class='label'><a id='x1-1048r2'></a></span><span class='ec-lmtt-9'>mov    %rsp,%rbp </span><br /><span class='label'><a id='x1-1049r3'></a></span><span class='ec-lmtt-9'>sub    $0x30,%rsp </span><br /><span class='label'><a id='x1-1050r4'></a></span><span class='ec-lmtt-9'>mov    %ecx,0x10(%rbp) </span><br /><span class='label'><a id='x1-1051r5'></a></span><span class='ec-lmtt-9'>mov    %rdx,0x18(%rbp) </span><br /><span class='label'><a id='x1-1052r6'></a></span><span class='ec-lmtt-9'>movl   $0x1,-0x4(%rbp) </span><br /><span class='label'><a id='x1-1053r7'></a></span><span class='ec-lmtt-9'>mov    0x18(%rbp),%rax </span><br /><span class='label'><a id='x1-1054r8'></a></span><span class='ec-lmtt-9'>add    $0x8,%rax </span><br /><span class='label'><a id='x1-1055r9'></a></span><span class='ec-lmtt-9'>(%rax),%rax </span><br /><span class='label'><a id='x1-1056r10'></a></span><span class='ec-lmtt-9'>mov    %rax,%rcx </span><br /><span class='label'><a id='x1-1057r11'></a></span><span class='ec-lmtt-9'>call   0x29 </span><br /><span class='label'><a id='x1-1058r12'></a></span><span class='ec-lmtt-9'>mov    %eax,-0xc(%rbp) </span><br /><span class='label'><a id='x1-1059r13'></a></span><span class='ec-lmtt-9'>movl   $0x1,-0x8(%rbp) </span><br /><span class='label'><a id='x1-1060r14'></a></span><span class='ec-lmtt-9'>jmp    0x45 </span><br /><span class='label'><a id='x1-1061r15'></a></span><span class='ec-lmtt-9'>mov    -0x8(%rbp),%eax </span><br /><span class='label'><a id='x1-1062r16'></a></span><span class='ec-lmtt-9'>mov    -0x4(%rbp),%edx </span><br /><span class='label'><a id='x1-1063r17'></a></span><span class='ec-lmtt-9'>imul   %edx,%eax </span><br /><span class='label'><a id='x1-1064r18'></a></span><span class='ec-lmtt-9'>mov    %eax,-0x4(%rbp) </span><br /><span class='label'><a id='x1-1065r19'></a></span><span class='ec-lmtt-9'>addl   $0x1,-0x8(%rbp) </span><br /><span class='label'><a id='x1-1066r20'></a></span><span class='ec-lmtt-9'>mov    -0x8(%rbp),%eax </span><br /><span class='label'><a id='x1-1067r21'></a></span><span class='ec-lmtt-9'>cmp    -0xc(%rbp),%eax </span><br /><span class='label'><a id='x1-1068r22'></a></span><span class='ec-lmtt-9'>jle    0x35 </span><br /><span class='label'><a id='x1-1069r23'></a></span><span class='ec-lmtt-9'>mov    -0x4(%rbp),%eax </span><br /><span class='label'><a id='x1-1070r24'></a></span><span class='ec-lmtt-9'>mov    %eax,%edx </span><br /><span class='label'><a id='x1-1071r25'></a></span><span class='ec-lmtt-9'>lea    0x0(%rip),%rax # 0x59 </span><br /><span class='label'><a id='x1-1072r26'></a></span><span class='ec-lmtt-9'>mov    %rax,%rcx </span><br /><span class='label'><a id='x1-1073r27'></a></span><span class='ec-lmtt-9'>call   0x61 </span><br /><span class='label'><a id='x1-1074r28'></a></span><span class='ec-lmtt-9'>nop </span><br /><span class='label'><a id='x1-1075r29'></a></span><span class='ec-lmtt-9'>add    $0x30,%rsp </span><br /><span class='label'><a id='x1-1076r30'></a></span><span class='ec-lmtt-9'>pop    %rbp</span>
<figcaption class='caption'><span class='id'>Listing 3:</span><span class='content'>Stripped Machine Code</span></figcaption><!-- tex4ht:label?: x1-1045r1  -->
</div></div>
<!-- l. 90 --><p class='indent'>   As can be seen by the stripped vs. unstripped comparison, there is very little (other than the function name)
that is different. In fact, once this code is sent through a decompiler (using Binary Ninja), the decompiled code can
be seen in figures <a href='#x1-1077r4'>4<!-- tex4ht:ref: lst:20210802:ninja  --></a> and <a href='#x1-1088r5'>5<!-- tex4ht:ref: lst:20210802:ninja2  --></a>.
</p>   
<div class='minipage'><!-- l. 93 -->
<a id='x1-1077r4'></a>
<a id='x1-1078'></a>
<div id='listing-4' class='lstlisting'><span class='label'><a id='x1-1079r1'></a></span><span class='ec-lmtt-8x-x-87'>int64_t factorial(int32_t arg1, </span><span class='ec-lmtk-10x-x-70'>void</span><span class='ec-lmtt-8x-x-87'>* arg2) </span><br /><span class='label'><a id='x1-1080r2'></a></span><span class='ec-lmtt-8x-x-87'>{ </span><br /><span class='label'><a id='x1-1081r3'></a></span><span class='ec-lmtt-8x-x-87'>        int32_t var_c = 1; </span><br /><span class='label'><a id='x1-1082r4'></a></span><span class='ec-lmtt-8x-x-87'>        int32_t rax_3 = atoi(*(arg2 + 8)); </span><br /><span class='label'><a id='x1-1083r5'></a></span><span class='ec-lmtt-8x-x-87'>        </span><span class='ec-lmtk-10x-x-70'>for</span><span class='ec-lmtt-8x-x-87'> (int32_t var_10 = 1; var_10 s </span><br /><span class='label'><a id='x1-1084r6'></a></span><span class='ec-lmtt-8x-x-87'>              &lt;= rax_3; var_10 = var_10 + 1) </span><br /><span class='label'><a id='x1-1085r7'></a></span><span class='ec-lmtt-8x-x-87'>                 var_c = var_10 * var_c; </span><br /><span class='label'><a id='x1-1086r8'></a></span><span class='ec-lmtt-8x-x-87'>        </span><span class='ec-lmtk-10x-x-70'>return</span><span class='ec-lmtt-8x-x-87'> printf(_.rdata, zx.q(var_c)); </span><br /><span class='label'><a id='x1-1087r9'></a></span><span class='ec-lmtt-8x-x-87'>}</span>
<figcaption class='caption'><span class='id'>Listing 4:</span><span class='content'>Unstripped Decompilation with Binary
Ninja</span></figcaption><!-- tex4ht:label?: x1-1077r1  -->
</div>
                                                                                         
                                                                                         
</div> <div class='minipage'><!-- l. 106 -->
<a id='x1-1088r5'></a>
<a id='x1-1089'></a>
<div id='listing-5' class='lstlisting'><span class='label'><a id='x1-1090r1'></a></span><span class='ec-lmtt-8x-x-87'>int64_t sub_100401080(int32_t arg1, </span><span class='ec-lmtk-10x-x-70'>void</span><span class='ec-lmtt-8x-x-87'>* arg2) </span><br /><span class='label'><a id='x1-1091r2'></a></span><span class='ec-lmtt-8x-x-87'>{ </span><br /><span class='label'><a id='x1-1092r3'></a></span><span class='ec-lmtt-8x-x-87'>        int32_t var_c = 1; </span><br /><span class='label'><a id='x1-1093r4'></a></span><span class='ec-lmtt-8x-x-87'>        int32_t rax_3 = atoi(*(arg2 + 8)); </span><br /><span class='label'><a id='x1-1094r5'></a></span><span class='ec-lmtt-8x-x-87'>        </span><span class='ec-lmtk-10x-x-70'>for</span><span class='ec-lmtt-8x-x-87'> (int32_t var_10 = 1; var_10 s </span><br /><span class='label'><a id='x1-1095r6'></a></span><span class='ec-lmtt-8x-x-87'>              &lt;= rax_3; var_10 = var_10 + 1) </span><br /><span class='label'><a id='x1-1096r7'></a></span><span class='ec-lmtt-8x-x-87'>                 var_c = var_10 * var_c; </span><br /><span class='label'><a id='x1-1097r8'></a></span><span class='ec-lmtt-8x-x-87'>        </span><span class='ec-lmtk-10x-x-70'>return</span><span class='ec-lmtt-8x-x-87'> printf(data_100403000, zx.q(var_c)); </span><br /><span class='label'><a id='x1-1098r9'></a></span><span class='ec-lmtt-8x-x-87'>}</span>
<figcaption class='caption'><span class='id'>Listing 5:</span><span class='content'>Stripped  Decompilation  with  Binary
Ninja</span></figcaption><!-- tex4ht:label?: x1-1088r1  -->
</div></div>
<!-- l. 119 --><p class='indent'>   While compilation and obfuscation definitely make it more difficult to glean the original meaning of software, it’s
not impossible to trace through the decompilation and figure out the original intent of the developer. If source code
is protected because of what it does, the binary generated from that source code should probably be handled with
the same protections.
                                                                                         
                                                                                         
</p>   
<h3 class='sectionHead'><a id='x1-20001'></a>References</h3>
<!-- l. 46 --><p class='noindent'>    
</p>
<dl class='thebibliography'><dt id='X0-swatips' class='thebibliography'>
[1]  
</dt><dd id='bib-1' class='thebibliography'>
<!-- l. 46 --><p class='noindent'><a id='cite.0@swatips'></a>Jon Hood, ed. <span class='rm-lmri-10'>SwATips</span>. <a href='https://www.SwATips.com/' class='url'><span class='ec-lmtt-10'>https://www.SwATips.com/</span></a>.</p></dd></dl>
 
</body> 
</html>