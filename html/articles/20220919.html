<!DOCTYPE html>
<html xml:lang='en-US' lang='en-US'>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Commercial National Security Algorithm (CNSA) Suite 2.0</title>
<link rel="stylesheet" href="../styles.css">
<script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4110907817782130" crossorigin="anonymous"></script>
<style>
 
/* start css.sty */
.ec-lmbx-12x-x-144{font-size:172%; font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmbx-12x-x-144{ font-weight: bold;}
.ec-lmr-12{font-size:120%;}
.ec-lmr-9{font-size:90%;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmr-8{font-size:80%;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmbx-10{ font-weight: bold;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmri-10{ font-style:italic;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
.ec-lmcsc-10{ font-variant: small-caps;}
p{margin-top:0;margin-bottom:0}
p.indent{text-indent:0;}
p + p{margin-top:1em;}
p + div, p + pre {margin-top:1em;}
div + p, pre + p {margin-top:1em;}
a { overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; hyphens: auto; }
@media print {div.crosslinks {visibility:hidden;}}
table.tabular{border-collapse: collapse; border-spacing: 0;}
a img { border-top: 0; border-left: 0; border-right: 0; }
center { margin-top:1em; margin-bottom:1em; }
td center { margin-top:0em; margin-bottom:0em; }
.Canvas { position:relative; }
img.math{vertical-align:middle;}
div.par-math-display, div.math-display{text-align:center;}
body{ margin:1em auto; max-width:80ch; padding:0 .62em; }
h1,h2,h3,h4,h5 { line-height:1.2; }
@media print{ body{ max-width:none } }
.partHead, .likepartHead { font-size: 2em; }
.chapterHead, .likechapterHead { font-size: 1.7411em; }
.sectionHead, .likesectionHead { font-size: 1.5157em; }
.subsectionHead, .likesubsectionHead { font-size: 1.3195em; }
.subsubsectionHead, .likesubsubsectionHead { font-size: 1.1487em; }
 @media (prefers-color-scheme: dark) { img[src^="article"]{filter: invert(1); } } 
 body { background-color: Canvas; color: CanvasText; color-scheme: light dark; } 
li p.indent { text-indent: 0em }
li p:first-child{ margin-top:0em; }
li p:last-child, li div:last-child { margin-bottom:0.5em; }
li p:first-child{ margin-bottom:0; }
li p~ul:last-child, li p~ol:last-child{ margin-bottom:0.5em; }
.enumerate1 {list-style-type:decimal;}
.enumerate2 {list-style-type:lower-alpha;}
.enumerate3 {list-style-type:lower-roman;}
.enumerate4 {list-style-type:upper-alpha;}
div.newtheorem { margin-bottom: 2em; margin-top: 2em;}
div.newtheorem .head{font-weight: bold;}
.obeylines-h,.obeylines-v {white-space: nowrap; }
div.obeylines-v p { margin-top:0; margin-bottom:0; }
.overline{ text-decoration:overline; }
.overline img{ border-top: 1px solid black; }
td.displaylines {text-align:center; white-space:nowrap;}
.centerline {text-align:center;}
.rightline {text-align:right;}
pre.verbatim {font-family: monospace,monospace; text-align:left; clear:both; }
.fbox {padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.fbox {display:table}
div.center div.fbox {text-align:center; clear:both; padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.minipage{width:100%;}
div.center, div.center div.center {text-align: center; margin-left:1em; margin-right:1em;}
div.center div {text-align: left;}
div.flushright, div.flushright div.flushright {text-align: right;}
div.flushright div {text-align: left;}
div.flushleft {text-align: left;}
.underline{ text-decoration:underline; }
.underline img{ border-bottom: 1px solid black; margin-bottom:1pt; }
.framebox-c, .framebox-l, .framebox-r { padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
.framebox-c {text-align:center;}
.framebox-l {text-align:left;}
.framebox-r {text-align:right;}
span.thank-mark{ vertical-align: super }
span.footnote-mark sup.textsuperscript, span.footnote-mark a sup.textsuperscript{ font-size:80%; }
div.footnotes{border-top:solid 1px black; border-bottom:solid 1px black; padding-bottom:1ex; padding-top:0.5ex; margin-right:15%; margin-top:2ex; font-style:italic; font-size:85%;}
div.footnotes p{margin-top:0; margin-bottom:0; text-indent:0;}
code.verb{font-family:monospace,monospace;}
div.tabular, div.center div.tabular {text-align: center; margin-top:0.5em; margin-bottom:0.5em; }
table.tabular td p{margin-top:0em;}
table.tabular {margin-left: auto; margin-right: auto;}
td p:first-child{ margin-top:0em; }
td p:last-child{ margin-bottom:0em; }
div.td00{ margin-left:0pt; margin-right:0pt; }
div.td01{ margin-left:0pt; margin-right:5pt; }
div.td10{ margin-left:5pt; margin-right:0pt; }
div.td11{ margin-left:5pt; margin-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
td.td00{ padding-left:0pt; padding-right:0pt; }
td.td01{ padding-left:0pt; padding-right:5pt; }
td.td10{ padding-left:5pt; padding-right:0pt; }
td.td11{ padding-left:5pt; padding-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
.hline hr, .cline hr{ height : 0px; margin:0px; }
.hline td, .cline td{ padding: 0; }
.hline hr, .cline hr{border:none;border-top:1px solid black;}
.hline {border-top: 1px solid black;}
.hline + .vspace:last-child{display:none;}
.tabbing-right {text-align:right;}
div.float, div.figure {margin-left: auto; margin-right: auto;}
div.float img {text-align:center;}
div.figure img {text-align:center;}
.marginpar,.reversemarginpar {width:20%; float:right; text-align:left; margin-left:auto; margin-top:0.5em; font-size:85%; text-decoration:underline;}
.marginpar p,.reversemarginpar p{margin-top:0.4em; margin-bottom:0.4em;}
.reversemarginpar{float:left;}
table.equation {width:100%;}
.equation td{text-align:center; }
td.equation { margin-top:1em; margin-bottom:1em; } 
td.equation-label { width:5%; text-align:center; }
td.eqnarray4 { width:5%; white-space: normal; }
td.eqnarray2 { width:5%; }
table.eqnarray-star, table.eqnarray {width:100%;}
div.eqnarray{text-align:center;}
div.array {text-align:center;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.pmatrix img{vertical-align:middle;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.bar-css {text-decoration:overline;}
img.cdots{vertical-align:middle;}
.partToc a, .partToc, .likepartToc a, .likepartToc {line-height: 200%; font-weight:bold; font-size:110%;}
.index-item, .index-subitem, .index-subsubitem {display:block}
div.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:center; margin-top: 0.5rem;}
div.caption span.id{font-weight: bold; white-space: nowrap; }
h1.partHead{text-align: center}
p.bibitem { text-indent: -2em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
p.bibitem-p { text-indent: 0em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
.subsubsectionHead, .likesubsubsectionHead { font-size: 1em; }
.paragraphHead, .likeparagraphHead { margin-top:2em; font-weight: bold;}
.subparagraphHead, .likesubparagraphHead { font-weight: bold;}
.verse{white-space:nowrap; margin-left:2em}
div.maketitle {text-align:center;}
h2.titleHead{text-align:center;}
div.maketitle{ margin-bottom: 2em; }
div.author, div.date {text-align:center;}
div.thanks{text-align:left; margin-left:10%; font-size:85%; font-style:italic; }
div.abstract p {margin-left:5%; margin-right:5%;}
div.abstract {width:100%;}
.abstracttitle{text-align:center;margin-bottom:1em;}
.subsectionToc, .likesubsectionToc {margin-left:1em;}
.subsubsectionToc, .likesubsubsectionToc {margin-left:2em;}
.paragraphToc, .likeparagraphToc {margin-left:3em;}
.subparagraphToc, .likesubparagraphToc {margin-left:4em;}
figure.float, div.figure {margin-left: auto; margin-right: auto;}
figure.figure {text-align:center;}
figcaption.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:center;}
figcaption.caption span.id{font-weight: bold; white-space: nowrap; }
p + figcaption, img + figcaption{margin-top: 1em;}
.abstract{margin:1em;}
dt.printshorthands{float:left; clear:left; margin-right:1em;}
dd.thebibliography {margin-left: 2.5em;}
dt.thebibliography {float:left; clear:left; margin-right:1em;}
code.lstinline{font-family:monospace,monospace;}
pre.listings{font-family: monospace,monospace; white-space: pre-wrap; margin-top:0.5em; margin-bottom:0.5em; }
.lstlisting .label{margin-right:0.5em; }
pre.lstlisting{font-family: monospace,monospace; white-space: pre-wrap; margin-top:0.5em; margin-bottom:0.5em; text-align: left; }
pre.lstinputlisting{ font-family: monospace,monospace; white-space: pre-wrap; text-align: left; }
.lstinputlisting .label{margin-right:0.5em;}
.small-caps{font-variant: small-caps;}
.uline,.uline-math{ text-decoration:underline; }
.uuline,.uuline-math{ text-decoration:underline double; }
span.sout, .sout-math {text-decoration: line-through }
span.xout, .xout-math {text-decoration: line-through underline }
span.uwave, .uwave-math {text-decoration:underline wavy; }
span.dashuline, .dashuline-math {text-decoration:underline dashed;}
span.dotuline, .dotuline-math {text-decoration:underline dotted;}
.rotatebox{display: inline-block;}
#TBL-2-1{border-left: 1px solid black;}
#TBL-2-1{border-right:1px solid black;}
#TBL-2-2{border-right:1px solid black;}
#TBL-3-1{border-left: 1px solid black;}
#TBL-3-1{border-right:1px solid black;}
#TBL-3-2{border-right:1px solid black;}
#TBL-4-1{border-left: 1px solid black;}
#TBL-4-1{border-right:1px solid black;}
#TBL-4-2{border-right:1px solid black;}
#TBL-5-1{border-left: 1px solid black;}
#TBL-5-1{border-right:1px solid black;}
#TBL-5-2{border-right:1px solid black;}
/* end css.sty */

</style>
</head>
<body>
<div class="container">
<article>
<style>
  article {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    line-height: 1.7;
    color: #333;
  }

  article h1, article h2, article h3, article h4, article h5, article h6 {
    margin-top: 1.5em;
    margin-bottom: 0.5em;
    color: #222;
    font-weight: 600;
  }

  article h1 {
    font-size: 2em;
    border-bottom: 3px solid #667eea;
    padding-bottom: 10px;
    margin-top: 0;
  }

  article p {
    margin-bottom: 1em;
  }

  article a {
    color: #667eea;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  article a:hover {
    color: #764ba2;
    text-decoration: underline;
  }

  article code {
    background: #f5f5f5;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: 0.9em;
  }

  article pre {
    background: #f5f5f5;
    padding: 15px;
    border-radius: 5px;
    overflow-x: auto;
    margin: 1em 0;
    border-left: 4px solid #667eea;
  }

  article pre code {
    background: none;
    padding: 0;
    border-radius: 0;
  }

  article blockquote {
    border-left: 4px solid #667eea;
    padding-left: 15px;
    margin-left: 0;
    color: #666;
    font-style: italic;
  }

  article ul, article ol {
    margin-left: 2em;
    margin-bottom: 1em;
  }

  article li {
    margin-bottom: 0.5em;
  }

  article table {
    border-collapse: collapse;
    width: 100%;
    margin: 1em 0;
  }

  article th, article td {
    border: 1px solid #ddd;
    padding: 12px;
    text-align: left;
  }

  article th {
    background: #f5f5f5;
    font-weight: 600;
  }

  article tr:nth-child(even) {
    background: #f9f9f9;
  }

  .article-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 0;
    border-top: 1px solid #e0e0e0;
    margin-top: 40px;
    font-size: 0.95em;
  }

  .article-meta a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.3s ease;
  }

  .article-meta a:hover {
    color: #764ba2;
  }

  .home-link {
    display: inline-flex;
    align-items: center;
    gap: 5px;
  }

  .license-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .license-badge img {
    height: 21px;
    width: auto;
  }
</style>

<div class="article-meta">
  <div class="home-link">
    <a href="../index.php">‚Üê Back to Home</a>
  </div>
  <div style="display: flex; gap: 20px;">
    <a href="20220919.pdf">üìÑ View PDF</a>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" class="license-badge" title="Licensed under Creative Commons Attribution 4.0 International">
      <img src="images/by.svg" alt="CC-BY" />
    </a>
  </div>
</div>
<div class='maketitle'>
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class='titleHead'> <strong>Software Assurance Tips</strong><br />
A product of the Software Assurance Tips Team[<a id='x1-3'></a><a href='#cite.0_swatips'>2</a>]<br />
</h2>
 <div class='author'><span class='ec-lmr-12'>Jon Hood</span></div><br />
<div class='date'><span class='ec-lmr-12'>Monday 19</span><sup class='textsuperscript'><span class='ec-lmr-9'>th</span></sup><span class='ec-lmr-12'>¬†September, 2022</span></div>
</div>
                                                                                         
                                                                                         
   

<h3 class='sectionHead' id='commercial-national-security-algorithm-cnsa-suite-'><span class='titlemark'>1   </span> <a id='x1-10001'></a>Commercial National Security Algorithm (CNSA) Suite 2.0</h3>
<!-- l. 47 --><p class='noindent'><span class='ec-lmr-8'>Updated Tuesday 27</span><sup class='textsuperscript'><span class='ec-lmr-9'>th</span></sup><span class='ec-lmr-8'>¬†January, 2026</span>
</p><!-- l. 1 --><p class='indent'>   As the government switches to quantum-resistant and post-quantum cryptographic algorithms, the CNSA suite
(formerly Suite-B algorithms) is undergoing some changes with a new release: version 2.0. This release of the CNSA
suite includes the following information:[<a id='x1-1001'></a><a href='#cite.0_20220919_cnsa'>3</a>] </p>
<ul class='itemize1'>     
<li class='itemize'>a requirement to be compliant and support these algorithms by 2035
</li>
<li class='itemize'>     
<!-- l. 4 --><p class='noindent'>a requirement to use NIST 800-208 for application signing which includes: </p>
<ul class='itemize2'>         
<li class='itemize'>a recommendation to use at least LMS with the SHA-256/192 parameters or XMSS with any
parameters
</li>
<li class='itemize'>deprecation of all other algorithms by 2025 (2030 for current deployments)</li></ul>
</li>     
<li class='itemize'>a requirement to use FIPS PUB 197 for symmetric block cipher encryption, requiring 256-bit keys (systems
should already be doing this)
</li>
<li class='itemize'>a requirement to use FIPS PUB 180-4 for hashing, requiring either the SHA-384 or SHA-512 algorithms
(systems should already be doing this)
</li>
<li class='itemize'>a requirement to use CRYSTALS-Kyber for public-key encryption, requiring Level V parameters and a
deprecation of RSA, DH, and ECC once implemented by 2035
</li>
<li class='itemize'>a requirement to use CRYSTALS-Dilithium for digital signatures by 2035</li></ul>
<!-- l. 15 --><p class='indent'>   Navigating these new requirements imposes a technical hurdle, and acquisition managers should prepare for this
move in their timelines. This article attempts to help explain the requirements at a technical level to help drive the
transition. At the time of this writing, the algorithms in CNSA 2.0 are not included in any mainline cryptography
libraries. For the examples, the Open Quantum Safe (OQS) Project OpenSSL 1.1.1-stable snapshot 2022-08 (
<a class='url' href='https://github.com/open-quantum-safe/openssl/releases/tag/OQS-OpenSSL-1_1_1-stable-snapshot-2022-08'><span class='ec-lmtt-10'>https://github.com/open-quantum-safe/openssl/releases/tag/OQS-OpenSSL-1_1_1-stable-snapshot-2022-08</span></a>)
is used on a vanilla Ubuntu 22.04 installation, and the reference implementations for all algorithms are used for key
implementation.

                                                                                         
                                                                                         
</p>   
<h4 class='subsectionHead' id='software-and-firmware-signing'><span class='titlemark'>1.1   </span> <a id='x1-20001.1'></a>Software and Firmware Signing</h4>
<!-- l. 18 --><p class='noindent'>Software and firmware signing can begin transitioning to CNSA 2.0 immediately with plans to retire CNSA 1.0
support.
</p>   
<div class='table'>
                                                                                         
                                                                                         
<!-- l. 21 --><p class='indent' id='software-and-firmware-signing-algorithms-cnsa-vs-'>   <a id='x1-20011'></a></p><figure class='float'>
                                                                                         
                                                                                         
<div class='tabular'> <table class='tabular' id='TBL-2'><colgroup id='TBL-2-1g'><col id='TBL-2-1' /></colgroup><colgroup id='TBL-2-2g'><col id='TBL-2-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-2-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-2-1-1' style='white-space:normal; text-align:left;'> <!-- l. 23 --><p class='noindent'><strong>CNSA 1.0</strong>                                              </p></td>
                                               <td class='td11' id='TBL-2-1-2' style='white-space:normal; text-align:left;'> <!-- l. 23 --><p class='noindent'><strong>CNSA 2.0</strong>                                              </p></td></tr><tr class='hline'><td></td><td></td></tr><tr id='TBL-2-2-' style='vertical-align:baseline;'><td class='td
11' id='TBL-2-2-1' style='white-space:normal; text-align:left;'>
 <!-- l. 25 --><p class='noindent'>Elliptic    Curve    Digital    Signature    Algorithm
  (ECDSA) using P-384<br class='newline' />Rivest-Shamir-Adleman   (RSA)   using   minimum
  3072-bit modulus                                               </p>
</td>
                                               <td class='td11' id='TBL-2-2-2' style='white-space:normal; text-align:left;'> <!-- l. 25 --><p class='noindent'>Leighton-Micali Signature (LMS)<br class='newline' />Xtended Merkle Signature Scheme (XMSS)            
</p>
</td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                               </div>
<figcaption class='caption'><span class='id'>Table¬†1: </span><span class='content'>Software and Firmware Signing Algorithms: CNSA 1.0 vs 2.0</span></figcaption><!-- tex4ht:label?: x1-20011  -->
                                                                                         
                                                                                         
   
</figure>
</div>
<!-- l. 31 --><p class='indent'>   Current PKI infrastructure in the DoD only supports using RSA for digital signatures. Nevertheless, the LMS
reference implementation includes LMS key generation and signature verification for LMS with SHA-256, one of the
permitted signature algorithms in NIST SP 800-208.[<a id='x1-2002'></a><a href='#cite.0_20220919_800-208'>1</a>, ¬ß 4.1] Using the demo application that is available with the
reference from <a class='url' href='https://github.com/cisco/hash-sigs'><span class='ec-lmtt-10'>https://github.com/cisco/hash-sigs</span></a>, an application/firmware hashing mechanism can be
implemented:
</p>   
<!-- l. 33 -->
<p><a id='x1-2003r1'></a>   
</p><pre class='lstlisting' id='listing-1'><span class='label'><a id='x1-2004r1'></a>1</span><span style='color:#000000'><span class='ec-lmtt-10'>$</span></span><span style='color:#000000'> <span class='ec-lmtt-10'>./demo genkey mykey 10/8,5/1</span> 
</span><span class='label'><a id='x1-2005r2'></a>2</span><span style='color:#000000'><span class='ec-lmtt-10'>$</span></span><span style='color:#000000'> <span class='ec-lmtt-10'>./demo sign mykey myapp.exe</span> 
</span><span class='label'><a id='x1-2006r3'></a>3</span><span style='color:#000000'><span class='ec-lmtt-10'>$</span></span><span style='color:#000000'> <span class='ec-lmtt-10'>./demo verify mykey myapp.exe</span></span></pre>
<figcaption class='caption'><span class='id'>Listing¬†1: </span><span class='content'>LMS Signature of myapp.exe</span></figcaption><!-- tex4ht:label?: x1-2006r1.1  -->
<!-- l. 39 --><p class='indent'>   Line 1 will generate a <span class='ec-lmtt-10'>mykey.prv </span>and a <span class='ec-lmtt-10'>mykey.pub </span>file using 2 levels of Merkle trees. The first level has a height
of 10 and Winternitz parameter of 8, and the second level a height of 5 and Winternitz parameter of 1. The NIST
800-208 standard permits Merkle tree heights of 5, 10, 15, 20, or 25, and RFC 8554 specifies that the Winternitz
parameter may be 1, 2, 4, or 8. There are limits to the number of signatures an LMS key can be used
for, and higher Merkle tree heights can take a long time to generate a key (it took nearly 2 hours
for me to generate a key with <i>h</i> = 25). At <i>h</i> = 5, the key is only good for a handful of signatures.
Generally speaking, larger Merkle tree heights take longer to generate but can be safely used for more
signatures. Higher Winternitz parameters minimize the signature size while increasing the time. RFC
8554 documents that a single Merkle tree level generated with <span class='ec-lmtt-10'>15/8 </span>will be good for about 30,000
signatures, while a 2-level Merkle tree generated with <span class='ec-lmtt-10'>25/8,15/8 </span>would be good for more than 1 trillion
signatures.
</p><!-- l. 41 --><p class='indent'>   Line 2 signs a file (in this case, an executable) using <span class='ec-lmtt-10'>mykey.prv</span>. This generates a <span class='ec-lmtt-10'>myapp.exe.sig </span>file with
the signature. An additional note of caution should be made: each signature advances the private
key. <span class='ec-lmtt-10'>mykey.prv </span>changes after every valid signature. If signatures are generated using the same key
information more than once, the security of those hashes may leak information about the private key.
Backing up the private key is not sufficient: a backup solution must back up the key <i>with the number of
signatures that have been made using it</i>, and a restoration process must advance the key by that many
signatures.
</p><!-- l. 43 --><p class='indent'>   Line 3 only needs to have <span class='ec-lmtt-10'>mykey.pub </span>present to verify the signature on another machine.

</p>   
<h4 class='subsectionHead' id='symmetric-key-algorithms'><span class='titlemark'>1.2   </span> <a id='x1-30001.2'></a>Symmetric Key Algorithms</h4>
<!-- l. 48 --><p class='noindent'>No change is made between CNSA 1.0 and CNSA 2.0 for symmetric block ciphers. AES with 256-bit keys is the only
algorithm permitted.
</p>   
<div class='table'>
                                                                                         
                                                                                         
<!-- l. 51 --><p class='indent' id='symmetric-block-ciphers-cnsa-vs-'>   <a id='x1-30012'></a></p><figure class='float'>
                                                                                         
                                                                                         
<div class='tabular'> <table class='tabular' id='TBL-3'><colgroup id='TBL-3-1g'><col id='TBL-3-1' /></colgroup><colgroup id='TBL-3-2g'><col id='TBL-3-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-3-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-3-1-1' style='white-space:normal; text-align:left;'> <!-- l. 53 --><p class='noindent'><strong>CNSA 1.0</strong>                                              </p></td>
                                               <td class='td11' id='TBL-3-1-2' style='white-space:normal; text-align:left;'> <!-- l. 53 --><p class='noindent'><strong>CNSA 2.0</strong>                                              </p></td></tr><tr class='hline'><td></td><td></td></tr><tr id='TBL-3-2-' style='vertical-align:baseline;'><td class='td
11' id='TBL-3-2-1' style='white-space:normal; text-align:left;'>
 <!-- l. 55 --><p class='noindent'>Advanced   Encryption   Standard   (AES)   using
  256-bit keys                                                      </p>
</td><td class='td11' id='TBL-3-2-2' style='white-space:normal; text-align:left;'> <!-- l. 55 --><p class='noindent'>Advanced   Encryption   Standard   (AES)   using 
256-bit keys                                                     
</p>
</td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                               </div>
<figcaption class='caption'><span class='id'>Table¬†2: </span><span class='content'>Symmetric Block Ciphers: CNSA 1.0 vs 2.0</span></figcaption><!-- tex4ht:label?: x1-30012  -->
                                                                                         
                                                                                         
   
</figure>
</div>   

<h4 class='subsectionHead' id='hashing'><span class='titlemark'>1.3   </span> <a id='x1-40001.3'></a>Hashing</h4>
<!-- l. 63 --><p class='noindent'>CNSA 2.0 officially adds SHA-512 as an approved hash, but continues to permit SHA-384 as an approved hashing
algorithm. </p><div class='table'>
                                                                                         
                                                                                         
<!-- l. 65 --><p class='indent' id='hashing-cnsa-vs-'>   <a id='x1-40013'></a></p><figure class='float'>
                                                                                         
                                                                                         
<div class='tabular'> <table class='tabular' id='TBL-4'><colgroup id='TBL-4-1g'><col id='TBL-4-1' /></colgroup><colgroup id='TBL-4-2g'><col id='TBL-4-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-4-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-4-1-1' style='white-space:normal; text-align:left;'> <!-- l. 67 --><p class='noindent'><strong>CNSA 1.0</strong>                                              </p></td>
                                               <td class='td11' id='TBL-4-1-2' style='white-space:normal; text-align:left;'> <!-- l. 67 --><p class='noindent'><strong>CNSA 2.0</strong>                                              </p></td></tr><tr class='hline'><td></td><td></td></tr><tr id='TBL-4-2-' style='vertical-align:baseline;'><td class='td
11' id='TBL-4-2-1' style='white-space:normal; text-align:left;'>
 <!-- l. 69 --><p class='noindent'>Secure  Hash  Algorithm  2  (SHA-2)  with  384-bit
  digests (SHA-384)                                              </p>
</td><td class='td11' id='TBL-4-2-2' style='white-space:normal; text-align:left;'> <!-- l. 69 --><p class='noindent'>Secure Hash Algorithm 2 (SHA-2) with 384-bit or 
512-bit digests (SHA-384 or SHA-512)                  
</p>
</td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                               </div>
<figcaption class='caption'><span class='id'>Table¬†3: </span><span class='content'>Hashing: CNSA 1.0 vs 2.0</span></figcaption><!-- tex4ht:label?: x1-40013  -->
                                                                                         
                                                                                         
   
</figure>
</div>
<!-- l. 75 --><p class='indent'>   Some may notice that internal hashes in the software and firmware signing algorithms use smaller hash sizes or
different hashing algorithms. For example, LMS permits the use of SHAKE-256, one of the unapproved SHA-3
algorithms from FIPS 202, internally. ‚ÄúNSA has no concerns about this, but does not anticipate approving SHA-3
algorithms for general-purpose use at this time.‚Äù[<a id='x1-4002'></a><a href='#cite.0_20220919_cnsafaq'>4</a>]

</p>   
<h4 class='subsectionHead' id='asymmetric-digital-signatures-and-key-establishment'><span class='titlemark'>1.4   </span> <a id='x1-50001.4'></a>Asymmetric Digital Signatures and Key Establishment</h4>
<!-- l. 79 --><p class='noindent'>CNSA 2.0 deprecates all of the algorithms of CNSA 1.0, requiring the use of the CRYSTALS-Dilithium algorithm.
</p><div class='table'>
                                                                                         
                                                                                         
<!-- l. 81 --><p class='indent' id='asymmetric-digital-signature-and-key-establishment-cnsa-vs-'>   <a id='x1-50014'></a></p><figure class='float'>
                                                                                         
                                                                                         
<div class='tabular'> <table class='tabular' id='TBL-5'><colgroup id='TBL-5-1g'><col id='TBL-5-1' /></colgroup><colgroup id='TBL-5-2g'><col id='TBL-5-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-5-1-' style='vertical-align:baseline;'><td class='td11' id='TBL-5-1-1' style='white-space:normal; text-align:left;'> <!-- l. 83 --><p class='noindent'><strong>CNSA 1.0</strong>                                              </p></td>
                                               <td class='td11' id='TBL-5-1-2' style='white-space:normal; text-align:left;'> <!-- l. 83 --><p class='noindent'><strong>CNSA 2.0</strong>                                              </p></td></tr><tr class='hline'><td></td><td></td></tr><tr id='TBL-5-2-' style='vertical-align:baseline;'><td class='td
11' id='TBL-5-2-1' style='white-space:normal; text-align:left;'>
 <!-- l. 85 --><p class='noindent'>Rivest-Shamir-Adleman   (RSA)   with   minimum
  3072-bit modulus<br class='newline' />Elliptic                                                 Curve
  Digital Signature Algorithm (ECDSA) using curve
  P-384<br class='newline' />Diffie-Hellman (DH) Key Exchange with minimum
  3072-bit modulus<br class='newline' />Elliptic                                                 Curve
  Diffie-Hellman (ECDH) Key Exchange using curve
  P-384                                                              </p>
</td>
                                               <td class='td11' id='TBL-5-2-2' style='white-space:normal; text-align:left;'> <!-- l. 85 --><p class='noindent'>CRYSTALS-Kyber at Level V<br class='newline' />CRYSTALS-Dilithium at Level V                        
</p>
</td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                               </div>
<figcaption class='caption'><span class='id'>Table¬†4: </span><span class='content'>Asymmetric Digital Signature and Key Establishment: CNSA 1.0 vs 2.0</span></figcaption><!-- tex4ht:label?: x1-50014  -->
                                                                                         
                                                                                         
   
</figure>
</div>
<!-- l. 91 --><p class='indent'>   To achieve NIST Level V functionality for the CRYSTALS-Kyber algorithm, the CRYSTALS-Kyber parameters
must be set to use K<span class='small-caps'>yber</span>1024 or K<span class='small-caps'>yber</span>1024-90s. While both parameter sets are permitted by CNSA 2.0,
K<span class='small-caps'>yber</span>1024 uses SHAKE and SHA-3 internally, both of which, on their own, are unapproved algorithms. Instead,
K<span class='small-caps'>yber</span>1024-90s uses AES-256-CTR and SHA-2 internally, using SHAKE-256 only for the Extendable-Output
Function (XOF).
</p><!-- l. 93 --><p class='indent'>   Amazon Web Services (AWS) and the Open Quantum Safe (OQS) project implement CRYSTALS. While
production implementations are not recommended yet, configuring the OQS port of OpenSSL so that it uses
CRYSTALS-Kyber can be done with the command in Listing¬†<a href='#x1-5002r2'>2<!-- tex4ht:ref: lst:20220919:kyber  --></a>. This will configure OpenSSL to use the CNSA 2.0
implementations of K<span class='small-caps'>yber</span>1024.
</p>   
<!-- l. 95 -->
<p><a id='x1-5002r2'></a>   
</p><pre class='lstlisting' id='listing-2'><span class='label'><a id='x1-5003r1'></a></span><span style='color:#000000'><span class='ec-lmtt-10'>$</span></span><span style='color:#000000'> <span class='ec-lmtt-10'>./Configure -DOQS_DEFAULT_GROUPS="kyber1024,p521_kyber1024,kyber90s1024,p521_kyber90s1024"</span></span></pre>
<figcaption class='caption'><span class='id'>Listing¬†2: </span><span class='content'>Configuring OpenSSL TLS 1.3 for using CRYSTALS-Kyber</span></figcaption><!-- tex4ht:label?: x1-5003r1.4  -->
<!-- l. 99 --><p class='indent'>   You may notice that the implementation in OQS OpenSSL includes key exchange using ECDH with the P-521
curve, a curve not permitted under CNSA 1.0 and 2.0. There is not yet a reference implementation for OQS
using CRYSTALS-Dilithium; however, we should see updates to the standard to implement this soon.
Currently, only the Dilthium5 parameter sets achieve NIST Level V functionality. Currently, both
Dilithium5 and Dilithium5-AES (where AES-256-CTR and SHA-2 are used instead of SHAKE-256)
achieve the CNSA 2.0 parameter goals. This creates a public key of 2592-bytes and a secret key of
4864-bytes.
</p><!-- l. 101 --><p class='indent'>   During the CNSA 1.0 to 2.0 transition, there will likely be several years where both implementations continue to
exist. During this time period, expect to see several hybrid implementations (such as K<span class='small-caps'>yber</span>‚Äôs ‚Äú90s‚Äù parameter sets
and Dilthium‚Äôs AES algorithm options. These will likely begin to fade out of use as the 1.0 suite continues its slow
march to obsolescence.

</p>   
<h4 class='subsectionHead' id='conclusion'><span class='titlemark'>1.5   </span> <a id='x1-60001.5'></a>Conclusion</h4>
<!-- l. 104 --><p class='noindent'>We are likely more than a decade away from seeing CNSA-2.0-only implementations; however, for project
acquisitions and contract writers, it may be necessary to plan for these architecture changes before the next contract
awards. The CNSA 2.0 implementation timeline indicates that the hybrid approaches will start rolling out
in the 2025 timeframe with preference given to the 2.0 algorithms over the 1.0 algorithms by 2030.
Finally, we should see the obsolescence of 1.0 as it is replaced with 2.0-only implementations in the
2033-2035 timeframe. As with most government mandates, expect delays, but prepare for the best. We‚Äôll
know if the timeline is on-track if the final CRYSTALS parameter sets are published by the end of
2024.
                                                                                         
                                                                                         
   

</p>   
<h3 class='sectionHead' id='references'><a id='x1-7000'></a>References</h3>
<!-- l. 52 --><p class='noindent'>    
</p>
<dl class='thebibliography'><dt class='thebibliography' id='X0-20220919_800-208'>
[1]  
</dt><dd class='thebibliography' id='bib-1'>
<!-- l. 52 --><p class='noindent'><a id='cite.0_20220919_800-208'></a>David Cooper et al. <span class='uline'>Recommendation for Stateful Hash-Based Signature Schemes</span>. Tech. rep. Special
Publication (SP) 800-208. Washington, D.C.: National Institute of Standards and Technology, 2020.
<span class='small-caps'>doi</span>:                                            <a href='https://doi.org/10.6028/NIST.SP.800-208'>10.6028/NIST.SP.800-208</a>.                      <span class='small-caps'>url</span>:                      
<a class='url' href='https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-208.pdf'><span class='ec-lmtt-10'>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-208.pdf</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-swatips'>
[2]  
</dt><dd class='thebibliography' id='bib-2'>
<!-- l. 52 --><p class='noindent'><a id='cite.0_swatips'></a>Jon Hood, ed. <span class='uline'>SwATips</span>. <a class='url' href='https://www.SwATips.com/'><span class='ec-lmtt-10'>https://www.SwATips.com/</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20220919_cnsa'>
[3]  
</dt><dd class='thebibliography' id='bib-3'>
<!-- l. 52 --><p class='noindent'><a id='cite.0_20220919_cnsa'></a>National
Security Agency. ‚ÄúAnnouncing the Commercial National Security Algorithm Suite 2.0‚Äù. In: (2022). <span class='small-caps'>url</span>: 
<a class='url' href='https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF'><span class='ec-lmtt-10'>https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20220919_cnsafaq'>
[4]  
</dt><dd class='thebibliography' id='bib-4'>
<!-- l. 52 --><p class='noindent'><a id='cite.0_20220919_cnsafaq'></a>National                                Security                                Agency.                                ‚ÄúThe
Commercial National Security Algorithm Suite 2.0 and Quantum Computing FAQ‚Äù. In: (2022). <span class='small-caps'>url</span>: 
<a class='url' href='https://media.defense.gov/2022/Sep/07/2003071836/-1/-1/0/CSI_CNSA_2.0_FAQ_.PDF'><span class='ec-lmtt-10'>https://media.defense.gov/2022/Sep/07/2003071836/-1/-1/0/CSI_CNSA_2.0_FAQ_.PDF</span></a>.</p></dd></dl>
 
</article>
<footer>
<p>&copy; 2021-2026 Software Assurance Tips. Some rights reserved. Please see the terms of the Creative Commons Attribution license.</p>
</footer>
</div>
