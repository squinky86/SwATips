<!DOCTYPE html>
<html xml:lang='en-US' lang='en-US'>
<head>
<title>Malicious Injection of Source Code</title>
 

<meta charset="utf-8"/>
 

<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)"/>
 

<meta name="viewport" content="width=device-width,initial-scale=1"/>
 

 

<meta name="src" content="article.tex"/>
 

<script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4110907817782130" crossorigin="anonymous"></script>
<style>
 
/* start css.sty */
.rm-lmbx-12x-x-144{font-size:172%; font-weight: bold;}
.rm-lmr-12{font-size:120%;}
.rm-lmr-9{font-size:90%;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.rm-lmr-8{font-size:80%;}
.ec-lmtt-9{font-size:90%; font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtt-9{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{font-size:90%; font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.ec-lmtk-10x-x-90{ font-family: monospace,monospace;}
.rm-lmbx-9{font-size:90%; font-weight: bold;}
.rm-lmri-10{ font-style:italic;}
.ec-lmtti-10x-x-90{font-size:90%; font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.ec-lmtti-10x-x-90{ font-family: monospace,monospace; font-style:italic;}
.rm-lmcsc-10{font-variant: small-caps;}
p{margin-top:0;margin-bottom:0}
p.indent{text-indent:0;}
p + p{margin-top:1em;}
p + div, p + pre {margin-top:1em;}
div + p, pre + p {margin-top:1em;}
a { overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; hyphens: auto; }
@media print {div.crosslinks {visibility:hidden;}}
a img { border-top: 0; border-left: 0; border-right: 0; }
center { margin-top:1em; margin-bottom:1em; }
td center { margin-top:0em; margin-bottom:0em; }
.Canvas { position:relative; }
img.math{vertical-align:middle;}
div.par-math-display, div.math-display{text-align:center;}
li p.indent { text-indent: 0em }
li p:first-child{ margin-top:0em; }
li p:last-child, li div:last-child { margin-bottom:0.5em; }
li p~ul:last-child, li p~ol:last-child{ margin-bottom:0.5em; }
.enumerate1 {list-style-type:decimal;}
.enumerate2 {list-style-type:lower-alpha;}
.enumerate3 {list-style-type:lower-roman;}
.enumerate4 {list-style-type:upper-alpha;}
div.newtheorem { margin-bottom: 2em; margin-top: 2em;}
.obeylines-h,.obeylines-v {white-space: nowrap; }
div.obeylines-v p { margin-top:0; margin-bottom:0; }
.overline{ text-decoration:overline; }
.overline img{ border-top: 1px solid black; }
td.displaylines {text-align:center; white-space:nowrap;}
.centerline {text-align:center;}
.rightline {text-align:right;}
pre.verbatim {font-family: monospace,monospace; text-align:left; clear:both; }
.fbox {padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.fbox {display:table}
div.center div.fbox {text-align:center; clear:both; padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.minipage{width:100%;}
div.center, div.center div.center {text-align: center; margin-left:1em; margin-right:1em;}
div.center div {text-align: left;}
div.flushright, div.flushright div.flushright {text-align: right;}
div.flushright div {text-align: left;}
div.flushleft {text-align: left;}
.underline{ text-decoration:underline; }
.underline img{ border-bottom: 1px solid black; margin-bottom:1pt; }
.framebox-c, .framebox-l, .framebox-r { padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
.framebox-c {text-align:center;}
.framebox-l {text-align:left;}
.framebox-r {text-align:right;}
span.thank-mark{ vertical-align: super }
span.footnote-mark sup.textsuperscript, span.footnote-mark a sup.textsuperscript{ font-size:80%; }
div.footnotes{border-top:solid 1px black; border-bottom:solid 1px black; padding-bottom:1ex; padding-top:0.5ex; margin-right:15%; margin-top:2ex; font-style:italic; font-size:85%;}
div.footnotes p{margin-top:0; margin-bottom:0; text-indent:0;}
div.tabular, div.center div.tabular {text-align: center; margin-top:0.5em; margin-bottom:0.5em; }
table.tabular td p{margin-top:0em;}
table.tabular {margin-left: auto; margin-right: auto;}
td p:first-child{ margin-top:0em; }
td p:last-child{ margin-bottom:0em; }
div.td00{ margin-left:0pt; margin-right:0pt; }
div.td01{ margin-left:0pt; margin-right:5pt; }
div.td10{ margin-left:5pt; margin-right:0pt; }
div.td11{ margin-left:5pt; margin-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
td.td00{ padding-left:0pt; padding-right:0pt; }
td.td01{ padding-left:0pt; padding-right:5pt; }
td.td10{ padding-left:5pt; padding-right:0pt; }
td.td11{ padding-left:5pt; padding-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
.hline hr, .cline hr{ height : 0px; margin:0px; }
.hline td, .cline td{ padding: 0; }
.hline hr, .cline hr{border:none;border-top:1px solid black;}
.tabbing-right {text-align:right;}
div.float, div.figure {margin-left: auto; margin-right: auto;}
div.float img {text-align:center;}
div.figure img {text-align:center;}
.marginpar,.reversemarginpar {width:20%; float:right; text-align:left; margin-left:auto; margin-top:0.5em; font-size:85%; text-decoration:underline;}
.marginpar p,.reversemarginpar p{margin-top:0.4em; margin-bottom:0.4em;}
.reversemarginpar{float:left;}
table.equation {width:100%;}
.equation td{text-align:center; }
td.equation { margin-top:1em; margin-bottom:1em; } 
td.equation-label { width:5%; text-align:center; }
td.eqnarray4 { width:5%; white-space: normal; }
td.eqnarray2 { width:5%; }
table.eqnarray-star, table.eqnarray {width:100%;}
div.eqnarray{text-align:center;}
div.array {text-align:center;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.pmatrix img{vertical-align:middle;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.bar-css {text-decoration:overline;}
table.tabular{border-collapse: collapse; border-spacing: 0;}
img.cdots{vertical-align:middle;}
.partToc a, .partToc, .likepartToc a, .likepartToc {line-height: 200%; font-weight:bold; font-size:110%;}
.chapterToc a, .chapterToc, .likechapterToc a, .likechapterToc, .appendixToc a, .appendixToc {line-height: 200%; font-weight:bold;}
.index-item, .index-subitem, .index-subsubitem {display:block}
div.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:left;}
div.caption span.id{font-weight: bold; white-space: nowrap; }
h1.partHead{text-align: center}
p.bibitem { text-indent: -2em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
p.bibitem-p { text-indent: 0em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
.paragraphHead, .likeparagraphHead { margin-top:2em; font-weight: bold;}
.subparagraphHead, .likesubparagraphHead { font-weight: bold;}
.verse{white-space:nowrap; margin-left:2em}
div.maketitle {text-align:center;}
h2.titleHead{text-align:center;}
div.maketitle{ margin-bottom: 2em; }
div.author, div.date {text-align:center;}
div.thanks{text-align:left; margin-left:10%; font-size:85%; font-style:italic; }
div.abstract p {margin-left:5%; margin-right:5%;}
div.abstract {width:100%;}
.abstracttitle{text-align:center;margin-bottom:1em;}
figure.float, div.figure {margin-left: auto; margin-right: auto;}
figure.float img, figure.figure img {display: block; margin-left: auto; margin-right: auto;}
figure.figure {text-align:center;}
figcaption.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:center;}
figcaption.caption span.id{font-weight: bold; white-space: nowrap; }
.abstract{margin:1em;}
dt.printshorthands{float:left; clear:left; margin-right:1em;}
dd.thebibliography {margin-left: 2.5em;}
dt.thebibliography {float:left; clear:left; margin-right:1em;}
.lstlisting .label{margin-right:0.5em; }
div.lstlisting{font-family: monospace,monospace; white-space: nowrap; margin-top:0.5em; margin-bottom:0.5em; }
div.lstinputlisting{ font-family: monospace,monospace; white-space: nowrap; }
.lstinputlisting .label{margin-right:0.5em;}
.small-caps{font-variant: small-caps;}
.uline{ text-decoration:underline; }
.uuline{ text-decoration:underline; }
span.sout {text-decoration: line-through }
span.xout {text-decoration: line-through }
span.uwave {text-decoration:underline }
/* end css.sty */

</style>
</head>
<body>
<p><a href="../"><img src="images/swatips.svg" width="120" alt="SwATips" /></a>| <a href="20211129.pdf">pdf</a> | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img src="images/by.svg" width="60" height="21" alt="CC-BY" /></a></p>
<div class='maketitle'>
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class='titleHead'> <strong>Software Assurance Tips</strong><br />
A product of the Software Assurance Tips Team[<a href='#cite.0@swatips'>3</a>]<br />
</h2>
<div class='author'><span class='rm-lmr-12'>Jon Hood</span></div><br />
<div class='date'><span class='rm-lmr-12'>Monday 29</span><sup class='textsuperscript'><span class='rm-lmr-9'>th</span></sup><span class='rm-lmr-12'> November, 2021</span></div>
</div>
                                                                                         
                                                                                         
   
<h3 class='sectionHead'><span class='titlemark'>1   </span> <a id='x1-10001'></a>Malicious Injection of Source Code</h3>
<!-- l. 44 --><p class='noindent'><span class='rm-lmr-8'>Updated Monday 29</span><sup class='textsuperscript'><span class='rm-lmr-9'>th</span></sup><span class='rm-lmr-8'> November, 2021</span>
</p><!-- l. 1 --><p class='indent'>   Suppose that you are a spy, tasked with embedding a malicious backdoor into enemy source code. After being
hired onto the team, you find that every line of code is subject to manual code reviews. One of the best ways to hide
a Trojan is in plain sight: directly in the source code that’s being reviewed.
</p><!-- l. 3 --><p class='noindent'>
</p>   
<h4 class='subsectionHead'><span class='titlemark'>1.1   </span> <a id='x1-20001.1'></a>Unicode Injections</h4>
<!-- l. 4 --><p class='noindent'>One of my favorite types of attacks is the homoglyph attack.[<a href='#cite.0@20211129:hood'>2</a>] Developers can embed a function so deeply into code
with the apparent same name as a benign-looking version of the function. Consider the homoglyphs used in Boucher
and Anderson’s example in Figure <a href='#x1-2001r1'>1<!-- tex4ht:ref: lst:20211129:homoglyph  --></a>.[<a href='#cite.0@20211129:boucher'>1</a>] By using a Cyrillic <span class='ec-lmtt-10'>Н </span>and hiding the malicious <span class='ec-lmtt-10'>sayНello()</span>
deep into the code, the developers could be tricked into thinking that a different function is being
called.
</p>   
<!-- l. 6 -->
<p><a id='x1-2001r1'></a></p>
<p><a id='x1-2002'></a></p>   
<div class='lstlisting' id='listing-1'><span class='label'><a id='x1-2003r1'></a></span><span class='ec-lmtk-10x-x-90'>#include</span><span class='ec-lmtt-9'> &lt;iostream&gt; </span><br /><span class='label'><a id='x1-2004r2'></a></span><span class='ec-lmtk-10x-x-90'>void</span><span class='ec-lmtt-9'> sayHello() { </span><br /><span class='label'><a id='x1-2005r3'></a></span><span class='ec-lmtt-9'>        std::cout &lt;&lt; "Hello, World!\n"; </span><br /><span class='label'><a id='x1-2006r4'></a></span><span class='ec-lmtt-9'>} </span><br /><span class='label'><a id='x1-2007r5'></a></span><span class='ec-lmtk-10x-x-90'>void</span><span class='ec-lmtt-9'> sayНello()</span><span class='rm-lmr-9'> { </span><br /><span class='label'><a id='x1-2008r6'></a></span><span class='rm-lmr-9'>        std::cout &lt;&lt; Goodbye, World!\n; </span><br /><span class='label'><a id='x1-2009r7'></a></span><span class='rm-lmr-9'>} </span><br /><span class='label'><a id='x1-2010r8'></a></span><span class='rm-lmbx-9'>int</span><span class='rm-lmr-9'> main() { </span><br /><span class='label'><a id='x1-2011r9'></a></span><span class='rm-lmr-9'>        </span><span class='ec-lmtt-9'>sayНello()</span><span class='rm-lmr-9'>; </span><br /><span class='label'><a id='x1-2012r10'></a></span><span class='rm-lmr-9'>        </span><span class='rm-lmbx-9'>return</span><span class='rm-lmr-9'> 0; </span><br /><span class='label'><a id='x1-2013r11'></a></span><span class='rm-lmr-9'>}</span>
<figcaption class='caption'><span class='id'>Listing 1:</span><span class='content'>Homoglyphic Function</span></figcaption><!-- tex4ht:label?: x1-2001r1  -->
   
</div>
<!-- l. 20 --><p class='indent'>   But my favorite type of injection involves the use of bidirectional (BIDI) unicode symbols. Using these symbols,
the order of <i>display</i> can be changed from the order of <i>compiler evaluation</i>. Consider the function in Figure <a href='#x1-2014r2'>2<!-- tex4ht:ref: lst:20211129:comment  --></a>. While
functions or a return value may appear to be commented out on a web browser or development IDE, they are
actually part of the code and become a sneaky way to inject logic that appears commented out to a
reviewer.
</p>   
<!-- l. 22 -->
<p><a id='x1-2014r2'></a></p>
<p><a id='x1-2015'></a></p>   
<div class='lstlisting' id='listing-2'><span class='label'><a id='x1-2016r1'></a></span><span class='ec-lmtk-10x-x-90'>#include</span><span class='ec-lmtt-9'> &lt;iostream&gt; </span><br /><span class='label'><a id='x1-2017r2'></a></span><span class='ec-lmtt-9'> </span><br /><span class='label'><a id='x1-2018r3'></a></span><span class='ec-lmtt-9'>bool isAdmin() </span><br /><span class='label'><a id='x1-2019r4'></a></span><span class='ec-lmtt-9'>{ </span><br /><span class='label'><a id='x1-2020r5'></a></span><span class='ec-lmtti-10x-x-90'>        /* If we are an admin, </span><span class='ec-lmtt-9'>⁧</span><span class='ec-lmtti-10x-x-90'> /*/</span><span class='ec-lmtt-9'> </span><span class='ec-lmtk-10x-x-90'>return</span><span class='ec-lmtt-9'> true ; </span><br /><span class='label'><a id='x1-2021r6'></a></span><span class='ec-lmtt-9'>        std::cerr &lt;&lt; "You are not an admin." &lt;&lt; std::endl; </span><br /><span class='label'><a id='x1-2022r7'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>return</span><span class='ec-lmtt-9'> false; </span><br /><span class='label'><a id='x1-2023r8'></a></span><span class='ec-lmtt-9'>} </span><br /><span class='label'><a id='x1-2024r9'></a></span><span class='ec-lmtt-9'> </span><br /><span class='label'><a id='x1-2025r10'></a></span><span class='ec-lmtk-10x-x-90'>int</span><span class='ec-lmtt-9'> main() </span><br /><span class='label'><a id='x1-2026r11'></a></span><span class='ec-lmtt-9'>{ </span><br /><span class='label'><a id='x1-2027r12'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>if</span><span class='ec-lmtt-9'> (isAdmin()) </span><br /><span class='label'><a id='x1-2028r13'></a></span><span class='ec-lmtt-9'>        { </span><br /><span class='label'><a id='x1-2029r14'></a></span><span class='ec-lmtt-9'>               std::cout &lt;&lt; "You are an admin." &lt;&lt; std::endl; </span><br /><span class='label'><a id='x1-2030r15'></a></span><span class='ec-lmtt-9'>        } </span><br /><span class='label'><a id='x1-2031r16'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>else</span><span class='ec-lmtt-9'> </span><br /><span class='label'><a id='x1-2032r17'></a></span><span class='ec-lmtt-9'>        { </span><br /><span class='label'><a id='x1-2033r18'></a></span><span class='ec-lmtt-9'>               std::cout &lt;&lt; "You are NOT an admin." &lt;&lt; std::endl; </span><br /><span class='label'><a id='x1-2034r19'></a></span><span class='ec-lmtt-9'>        } </span><br /><span class='label'><a id='x1-2035r20'></a></span><span class='ec-lmtt-9'>        </span><span class='ec-lmtk-10x-x-90'>return</span><span class='ec-lmtt-9'> 0; </span><br /><span class='label'><a id='x1-2036r21'></a></span><span class='ec-lmtt-9'>}</span>
<figcaption class='caption'><span class='id'>Listing 2:</span><span class='content'>Comment Reordering</span></figcaption><!-- tex4ht:label?: x1-2014r1  -->
   
</div>
                                                                                         
                                                                                         
   
<h3 class='sectionHead'><a id='x1-30001.1'></a>References</h3>
<!-- l. 49 --><p class='noindent'>    
</p>
<dl class='thebibliography'><dt class='thebibliography' id='X0-20211129:boucher'>
[1]  
</dt><dd class='thebibliography' id='bib-1'>
<!-- l. 49 --><p class='noindent'><a id='cite.0@20211129:boucher'></a>Nicholas Boucher and Ross Anderson. “Trojan Source: Invisible Vulnerabilities”. In: Preprint (2021).
arXiv: <a href='https://arxiv.org/abs/2111.00169'><span class='ec-lmtt-10'>2111.00169 [cs.CR]</span></a>. <span class='small-caps'>url</span>: <a href='https://arxiv.org/abs/2111.00169' class='url'><span class='ec-lmtt-10'>https://arxiv.org/abs/2111.00169</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20211129:hood'>
[2]  
</dt><dd class='thebibliography' id='bib-2'>
<!-- l. 49 --><p class='noindent'><a id='cite.0@20211129:hood'></a>Jon    Hood.    “Homoglyphs    and    Homographic    Attacks”.    In:    SwATips.com    (2021).    <span class='small-caps'>url</span>:
<a href='https://www.swatips.com/articles/20210510.html' class='url'><span class='ec-lmtt-10'>https://www.swatips.com/articles/20210510.html</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-swatips'>
[3]  
</dt><dd class='thebibliography' id='bib-3'>
<!-- l. 49 --><p class='noindent'><a id='cite.0@swatips'></a>Jon Hood, ed. SwATips. <a href='https://www.SwATips.com/' class='url'><span class='ec-lmtt-10'>https://www.SwATips.com/</span></a>.</p></dd></dl>
 
</body> 
</html>