<!DOCTYPE html>
<html xml:lang='en-US' lang='en-US'>
<head>
<title>Living off the Land</title>
 

<meta charset="utf-8"/>
 

<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)"/>
 

<meta name="viewport" content="width=device-width,initial-scale=1"/>
 

 

<meta name="src" content="article.tex"/>
 

<script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4110907817782130" crossorigin="anonymous"></script>
<style>
 
/* start css.sty */
.rm-lmbx-12x-x-144{font-size:172%; font-weight: bold;}
.rm-lmr-12{font-size:120%;}
.rm-lmr-9{font-size:90%;}
.ec-lmtt-10{ font-family: monospace,monospace;}
.rm-lmr-8{font-size:80%;}
.rm-lmri-10{ font-style:italic;}
.rm-lmcsc-10{font-variant: small-caps;}
.cmmi-7{font-size:70%;font-style: italic;}
p{margin-top:0;margin-bottom:0}
p.indent{text-indent:0;}
p + p{margin-top:1em;}
p + div, p + pre {margin-top:1em;}
div + p, pre + p {margin-top:1em;}
a { overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; hyphens: auto; }
@media print {div.crosslinks {visibility:hidden;}}
a img { border-top: 0; border-left: 0; border-right: 0; }
center { margin-top:1em; margin-bottom:1em; }
td center { margin-top:0em; margin-bottom:0em; }
.Canvas { position:relative; }
img.math{vertical-align:middle;}
div.par-math-display, div.math-display{text-align:center;}
li p.indent { text-indent: 0em }
li p:first-child{ margin-top:0em; }
li p:last-child, li div:last-child { margin-bottom:0.5em; }
li p~ul:last-child, li p~ol:last-child{ margin-bottom:0.5em; }
.enumerate1 {list-style-type:decimal;}
.enumerate2 {list-style-type:lower-alpha;}
.enumerate3 {list-style-type:lower-roman;}
.enumerate4 {list-style-type:upper-alpha;}
div.newtheorem { margin-bottom: 2em; margin-top: 2em;}
.obeylines-h,.obeylines-v {white-space: nowrap; }
div.obeylines-v p { margin-top:0; margin-bottom:0; }
.overline{ text-decoration:overline; }
.overline img{ border-top: 1px solid black; }
td.displaylines {text-align:center; white-space:nowrap;}
.centerline {text-align:center;}
.rightline {text-align:right;}
pre.verbatim {font-family: monospace,monospace; text-align:left; clear:both; }
.fbox {padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.fbox {display:table}
div.center div.fbox {text-align:center; clear:both; padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
div.minipage{width:100%;}
div.center, div.center div.center {text-align: center; margin-left:1em; margin-right:1em;}
div.center div {text-align: left;}
div.flushright, div.flushright div.flushright {text-align: right;}
div.flushright div {text-align: left;}
div.flushleft {text-align: left;}
.underline{ text-decoration:underline; }
.underline img{ border-bottom: 1px solid black; margin-bottom:1pt; }
.framebox-c, .framebox-l, .framebox-r { padding-left:3.0pt; padding-right:3.0pt; text-indent:0pt; border:solid black 0.4pt; }
.framebox-c {text-align:center;}
.framebox-l {text-align:left;}
.framebox-r {text-align:right;}
span.thank-mark{ vertical-align: super }
span.footnote-mark sup.textsuperscript, span.footnote-mark a sup.textsuperscript{ font-size:80%; }
div.footnotes{border-top:solid 1px black; border-bottom:solid 1px black; padding-bottom:1ex; padding-top:0.5ex; margin-right:15%; margin-top:2ex; font-style:italic; font-size:85%;}
div.footnotes p{margin-top:0; margin-bottom:0; text-indent:0;}
div.tabular, div.center div.tabular {text-align: center; margin-top:0.5em; margin-bottom:0.5em; }
table.tabular td p{margin-top:0em;}
table.tabular {margin-left: auto; margin-right: auto;}
td p:first-child{ margin-top:0em; }
td p:last-child{ margin-bottom:0em; }
div.td00{ margin-left:0pt; margin-right:0pt; }
div.td01{ margin-left:0pt; margin-right:5pt; }
div.td10{ margin-left:5pt; margin-right:0pt; }
div.td11{ margin-left:5pt; margin-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
td.td00{ padding-left:0pt; padding-right:0pt; }
td.td01{ padding-left:0pt; padding-right:5pt; }
td.td10{ padding-left:5pt; padding-right:0pt; }
td.td11{ padding-left:5pt; padding-right:5pt; }
table[rules] {border-left:solid black 0.4pt; border-right:solid black 0.4pt; }
.hline hr, .cline hr{ height : 0px; margin:0px; }
.hline td, .cline td{ padding: 0; }
.hline hr, .cline hr{border:none;border-top:1px solid black;}
.tabbing-right {text-align:right;}
div.float, div.figure {margin-left: auto; margin-right: auto;}
div.float img {text-align:center;}
div.figure img {text-align:center;}
.marginpar,.reversemarginpar {width:20%; float:right; text-align:left; margin-left:auto; margin-top:0.5em; font-size:85%; text-decoration:underline;}
.marginpar p,.reversemarginpar p{margin-top:0.4em; margin-bottom:0.4em;}
.reversemarginpar{float:left;}
table.equation {width:100%;}
.equation td{text-align:center; }
td.equation { margin-top:1em; margin-bottom:1em; } 
td.equation-label { width:5%; text-align:center; }
td.eqnarray4 { width:5%; white-space: normal; }
td.eqnarray2 { width:5%; }
table.eqnarray-star, table.eqnarray {width:100%;}
div.eqnarray{text-align:center;}
div.array {text-align:center;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.pmatrix img{vertical-align:middle;}
div.pmatrix {text-align:center;}
table.pmatrix {width:100%;}
span.bar-css {text-decoration:overline;}
table.tabular{border-collapse: collapse; border-spacing: 0;}
img.cdots{vertical-align:middle;}
.partToc a, .partToc, .likepartToc a, .likepartToc {line-height: 200%; font-weight:bold; font-size:110%;}
.chapterToc a, .chapterToc, .likechapterToc a, .likechapterToc, .appendixToc a, .appendixToc {line-height: 200%; font-weight:bold;}
.index-item, .index-subitem, .index-subsubitem {display:block}
div.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:left;}
div.caption span.id{font-weight: bold; white-space: nowrap; }
h1.partHead{text-align: center}
p.bibitem { text-indent: -2em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
p.bibitem-p { text-indent: 0em; margin-left: 2em; margin-top:0.6em; margin-bottom:0.6em; }
.paragraphHead, .likeparagraphHead { margin-top:2em; font-weight: bold;}
.subparagraphHead, .likesubparagraphHead { font-weight: bold;}
.verse{white-space:nowrap; margin-left:2em}
div.maketitle {text-align:center;}
h2.titleHead{text-align:center;}
div.maketitle{ margin-bottom: 2em; }
div.author, div.date {text-align:center;}
div.thanks{text-align:left; margin-left:10%; font-size:85%; font-style:italic; }
div.abstract p {margin-left:5%; margin-right:5%;}
div.abstract {width:100%;}
.abstracttitle{text-align:center;margin-bottom:1em;}
figure.float, div.figure {margin-left: auto; margin-right: auto;}
figure.float img, figure.figure img {display: block; margin-left: auto; margin-right: auto;}
figure.figure {text-align:center;}
figcaption.caption {text-indent:-2em; margin-left:3em; margin-right:1em; text-align:center;}
figcaption.caption span.id{font-weight: bold; white-space: nowrap; }
.abstract{margin:1em;}
dt.printshorthands{float:left; clear:left; margin-right:1em;}
dd.thebibliography {margin-left: 2.5em;}
dt.thebibliography {float:left; clear:left; margin-right:1em;}
.lstlisting .label{margin-right:0.5em; }
div.lstlisting{font-family: monospace,monospace; white-space: nowrap; margin-top:0.5em; margin-bottom:0.5em; }
div.lstinputlisting{ font-family: monospace,monospace; white-space: nowrap; }
.lstinputlisting .label{margin-right:0.5em;}
.small-caps{font-variant: small-caps;}
.uline{ text-decoration:underline; }
.uuline{ text-decoration:underline; }
span.sout {text-decoration: line-through }
span.xout {text-decoration: line-through }
span.uwave {text-decoration:underline }
/* end css.sty */

</style>
</head>
<body>
<p><a href="../"><img src="images/swatips.svg" width="120" alt="SwATips" /></a> | <a href="20210621.pdf">pdf</a> | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img src="images/by.svg" width="60" height="21" alt="CC-BY" /></a></p>
<div class='maketitle'>
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class='titleHead'> <strong>Software Assurance Tips</strong><br />
A product of the Software Assurance Tips Team[<a href='#cite.0@swatips'>2</a>]<br />
</h2>
<div class='author'><span class='rm-lmr-12'>Jon Hood</span></div><br />
<div class='date'><span class='rm-lmr-12'>Monday 21</span><sup class='textsuperscript'><span class='rm-lmr-9'>st</span></sup><span class='rm-lmr-12'> June, 2021</span></div>
</div>
                                                                                         
                                                                                         
   
<h3 class='sectionHead'><span class='titlemark'>1   </span> <a id='x1-10001'></a>Living off the Land</h3>
<!-- l. 42 --><p class='noindent'><span class='rm-lmr-8'>Updated Friday 6</span><sup class='textsuperscript'><span class='rm-lmr-9'>th</span></sup><span class='rm-lmr-8'> August, 2021</span>
</p><!-- l. 1 --><p class='indent'>   Living off the Land (LotL) refers to using the tools, scripts, libraries, and binaries that are native
and pre-installed with an environment.[<a href='#cite.0@20210621:rains2020cybersecurity'>6</a>, p. 299] Attackers use the existing tools of their exploited
environment to decrease their footprint and avoid detection, often blending in by using legitimate
tools and administrative functions in a malicious way.[<a href='#cite.0@20210621:calder2020cyber'>1</a>, p. 45] Nevertheless, developers can use LotL
concepts to decrease the attackable footprint of their software as a mitigation strategy against attacks as
well!
</p><!-- l. 3 --><p class='noindent'>
</p>   
<h4 class='subsectionHead'><span class='titlemark'>1.1   </span> <a id='x1-20001.1'></a>LotL: An Attacker’s Perspective</h4>
<!-- l. 5 --><p class='noindent'>When attacking an environment, penetration testing teams often attempt to take an inventory of
what is available to see what can be utilized to establish persistence and pivot in the environment
without detection. If the attacker has to install specialized tools and packages, intrusion detection and
prevention systems can be configured to look for those packages as part of a defense-in-depth mitigation
strategy.
</p><!-- l. 7 --><p class='noindent'>
</p>   
<h4 class='subsectionHead'><span class='titlemark'>1.2   </span> <a id='x1-30001.2'></a>LotL: A Defender’s Perspective</h4>
<!-- l. 9 --><p class='noindent'>Defensive (blue) teams should be familiar with the attacks and threats posed by penetration testing (red) teams. In
2013, the DoD used the following definition of Software Assurance: “the level of confidence that software functions
as intended and is free of vulnerabilities, either intentionally or unintentionally designed or inserted as part of the
software, throughout the life cycle.”[<a href='#cite.0@20210621:ndaa2013'>5</a>, p. 255 §933.e.2] In 2017, the Office for the Secretary of Defense clarified the
definition of “functions as intended” to mean “<i>only</i> functions as intended” by showing confidently that the software
meets functionality and test coverage requirements and also “does not perform unrequired functions.”[<a href='#cite.0@20210621:marien2017'>4</a>, p. 7] Since
2017, the caveat “and only as intended” has been codified as part of the DoD’s definition of Software Assurance.[<a href='#cite.0@20210621:hurt2017'>3</a>,
p. 2]
</p><!-- l. 11 --><p class='indent'>   Developers are often tempted by heavyweight frameworks that provide sundry capabilities. For low-assurance
tasks, these frameworks permit rapid development and deployment of solutions. In tactical environments, these
bloated dependencies are much more difficult to maintain. Large frameworks must be maintained and reviewed for
CVEs and security updates in their deployed environments, even when security findings affect areas of the
framework that are not utilized by the solution.
</p><!-- l. 13 --><p class='noindent'>
</p>   
<h4 class='subsectionHead'><span class='titlemark'>1.3   </span> <a id='x1-40001.3'></a>LotL In Practice</h4>
<!-- l. 15 --><p class='noindent'>Recently, one particular application provided a framework that used libzip, zlib, 7-Zip, and the System.IO.Compression
ZipArchive routines for reading in compressed files at different parts of the application. During the Software
Assurance scans, we were able to create a payload using the Zip Slip vulnerability to upload and execute any
payload we needed. During postmortem analysis, the developers cleaned up the vulnerability that was used, but
forgot to verify that another location of the code used a vulnerable version of 7-Zip that could stage the same
payload!
</p><!-- l. 17 --><p class='noindent'>
</p>   
<h4 class='subsectionHead'><span class='titlemark'>1.4   </span> <a id='x1-50001.4'></a>Mitigations</h4>
                                                                                         
                                                                                         
<!-- l. 19 --><p class='noindent'>Mitigations to attackers that attempt LotL techniques involve making sure that the land an attacker would get is
insufficient for staging more advanced attacks. When an attacker only gets access to a minimalist, sandboxed
island, there isn’t enough land to live on. They must either be noisy, terraforming the land into a new
environment and risking detection, or silently move on to another, more vulnerable environment to avoid
detection.
</p><!-- l. 21 --><p class='indent'>   Some additional information to consider: </p>
<ul class='itemize1'>     
<li class='itemize'>If installing a webserver, determine the languages web applications are written in. If there are no perl,
PHP, Ruby, or .NET applications, then why install those frameworks to begin with?
</li>     
<li class='itemize'>Watch for additional tools being installed. Why should the sandboxed web account have access to
netcat, telnet, or the entire suite of tools? Why is there a compiler installed on the server?
</li>     
<li class='itemize'>If a service does not need to be touched by a user, does it make sense to give that service its own
sandbox and account with access only to the application that needs it to run?</li></ul>
<!-- l. 28 --><p class='indent'>   A defender should follow the least-privilege and minimum functionality practices when developing software. By
refusing to give an attacker much land to live on, developers reduce their exposure space and discourage malicious
activities. As a byproduct of using minimal frameworks and dependencies, maintenance becomes easier, particularly
on disconnected and tactical systems.
</p><!-- l. 30 --><p class='indent'>   Containers that provide only the needed functionality should be preferred over monolithic containers that
provide entire operating systems and environments. By sandboxing user execution, an attacker that successfully gets
a foothold into an application is rewarded with their very own tiny sandbox to play in, while non-containerized,
multi-user execution often provides attackers with the keys to the entire kingdom. Compromise is not a fun topic to
consider, but risk prevention is not a binary, pwned-or-not decision. I’d prefer that my software not be compromised,
but if it should become impaired, I’d rather the malicious attacker only be able to steal the sandbox rather than the
entire kingdom!
</p><!-- l. 32 --><p class='indent'>   If you give a crook your sandbox, they’ll defecate in your sand. But if you give a crook your kingdom, they’ll
usurp your entire domain.
                                                                                         
                                                                                         
</p>   
<h3 class='sectionHead'><a id='x1-60001.4'></a>References</h3>
<!-- l. 47 --><p class='noindent'>    
</p>
<dl class='thebibliography'><dt class='thebibliography' id='X0-20210621:calder2020cyber'>
[1]  
</dt><dd class='thebibliography' id='bib-1'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@20210621:calder2020cyber'></a>Alan  Calder.  The Cyber Security Handbook. Prepare for, respond to and recover from cyber attacks.
IT Governance Publishing Ltd, 2020. <span class='small-caps'>isbn</span>: 978-1-78778-261-7.
</p>    
</dd>
<dt class='thebibliography' id='X0-swatips'>
[2]  
</dt><dd class='thebibliography' id='bib-2'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@swatips'></a>Jon Hood, ed. SwATips. <a href='https://www.SwATips.com/' class='url'><span class='ec-lmtt-10'>https://www.SwATips.com/</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20210621:hurt2017'>
[3]  
</dt><dd class='thebibliography' id='bib-3'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@20210621:hurt2017'></a>Thomas Hurt. Achieving DoD Software Assurance (SwA). Tech. rep. Springfield, VA: 20<span class='cmmi-7'>th</span> Annual NDIA
Systems Engineering Conference, Oct. 2017. <span class='small-caps'>url</span>: <a href='https://ndiastorage.blob.core.usgovcloudapi.net/ndia/2017/systems/Thursday/Track1/19911_Hurt.pdf' class='url'><span class='ec-lmtt-10'>https://ndiastorage.blob.core.usgovcloudapi.net/ndia/2017/systems/Thursday/Track1/19911_Hurt.pdf</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20210621:marien2017'>
[4]  
</dt><dd class='thebibliography' id='bib-4'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@20210621:marien2017'></a>John R. Marien and Robert A. Martin. Incorporating Software Assurance into Department of Defense Acquisition Contracts.
Tech. rep. Department of Defense (DoD) Software Assurance (SwA) Community of Practice (CoP)
Contract Language Working Group, 2017. <span class='small-caps'>url</span>: <a href='https://rt.cto.mil/wp-content/uploads/2019/06/Incorporating-SwA-Contracts-2017-11-15.pdf' class='url'><span class='ec-lmtt-10'>https://rt.cto.mil/wp-content/uploads/2019/06/Incorporating-SwA-Contracts-2017-11-15.pdf</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20210621:ndaa2013'>
[5]  
</dt><dd class='thebibliography' id='bib-5'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@20210621:ndaa2013'></a>NATIONAL DEFENSE AUTHORIZATION ACT FOR FISCAL YEAR 2013. Public Law 112–239.
Jan. 2013. <span class='small-caps'>url</span>: <a href='https://www.congress.gov/112/plaws/publ239/PLAW-112publ239.pdf' class='url'><span class='ec-lmtt-10'>https://www.congress.gov/112/plaws/publ239/PLAW-112publ239.pdf</span></a>.
</p>    
</dd>
<dt class='thebibliography' id='X0-20210621:rains2020cybersecurity'>
[6]  
</dt><dd class='thebibliography' id='bib-6'>
<!-- l. 47 --><p class='noindent'><a id='cite.0@20210621:rains2020cybersecurity'></a>Tim Rains. Cybersecurity Threats, Malware Trends, and Strategies. Learn to mitigate exploits, malware, phishing, and other social engineering attacks.
Packt Publishing, 2020. <span class='small-caps'>isbn</span>: 978-1-80020-589-5.</p></dd></dl>
 
</body> 
</html>